# 说明：复制一份为 .env（不要提交到 Git）

# ===== 必填：鉴权 =====
APP_TOKEN=change_me
# 兼容三方 API（OpenAI/Anthropic/Gemini）使用的密钥；不填则默认沿用 APP_TOKEN
COMPAT_API_KEY=

# ===== 必填：数据库 =====
DATABASE_URL=postgres://atri:change_me@db:5432/atri

# ===== 必填：聊天上游（OpenAI 兼容）=====
OPENAI_API_URL=
OPENAI_API_KEY=

# ===== 必填：向量/Embedding 上游 =====
EMBEDDINGS_API_URL=
EMBEDDINGS_API_KEY=
EMBEDDINGS_MODEL=

# ===== 可选：日记/档案专用上游（不填就用 OPENAI_*）=====
DIARY_API_URL=
DIARY_API_KEY=
DIARY_MODEL=

# ===== 可选：联网搜索 =====
TAVILY_API_KEY=

# ===== 媒体 =====
MEDIA_ROOT=/data/media
# 用于生成可访问的绝对 URL（例如 https://你的域名），不填则从请求头推断
PUBLIC_BASE_URL=https://example.com
# 媒体签名密钥（不填则回退用 APP_TOKEN）
MEDIA_SIGNING_KEY=

# ===== 管理接口（可选）=====
ADMIN_API_KEY=
# 用于加密存库的密钥（强烈建议配置；否则无法在 /admin 里保存上游 Key）
# 推荐生成：openssl rand -base64 32
ADMIN_CONFIG_ENCRYPTION_KEY=
# 额外允许访问 /admin 的来源 IP（逗号分隔），一般不需要；Docker 场景下可填宿主机网关 IP
ADMIN_ALLOWED_IPS=
# /admin 镜像更新检查（默认查 ghcr.io/mikuscat/atri-server:latest）
UPDATE_CHECK_IMAGE=ghcr.io/mikuscat/atri-server
UPDATE_CHECK_TAG=latest
# 当前运行镜像 digest（建议在部署平台注入，例如 sha256:...）
CURRENT_IMAGE_DIGEST=

# ===== 服务监听（可选）=====
HOST=0.0.0.0
PORT=3111

# ===== 定时任务（可选）=====
# 内置日记定时任务：默认开启；填 0/false 关闭
DIARY_CRON_ENABLED=1
# 每天跑日记的时间（按 DIARY_CRON_TIMEZONE 计算）
DIARY_CRON_TIME=23:59
# 默认 Asia/Shanghai
DIARY_CRON_TIMEZONE=Asia/Shanghai
# 补跑最近 N 天（默认 2：昨天+今天），避免服务宕机漏生成
DIARY_CRON_CATCHUP_DAYS=2

# ===== 向量重建（可选）=====
# 启动时自动全量重建 diary highlights 向量：
# - 不填：只有 hl:* 为空才重建
# - 1/true/force：强制重建
# - 0/false：禁用
MEMORY_REBUILD_ON_START=
